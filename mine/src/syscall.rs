use libc::user_regs_struct;

pub fn get_syscall(registers: user_regs_struct) -> &'static str {
    syscalls()
        .into_iter()
        .filter(|(i, _name)| i == &registers.orig_rax)
        .next()
        .unwrap()
        .1
}

fn syscalls() -> Vec<(u64, &'static str)> {
    vec![
        (0, "__NR_read"),
        (1, "__NR_write"),
        (2, "__NR_open"),
        (3, "__NR_close"),
        (4, "__NR_stat"),
        (5, "__NR_fstat"),
        (6, "__NR_lstat"),
        (7, "__NR_poll"),
        (8, "__NR_lseek"),
        (9, "__NR_mmap"),
        (10, "__NR_mprotect"),
        (11, "__NR_munmap"),
        (12, "__NR_brk"),
        (13, "__NR_rt_sigaction"),
        (14, "__NR_rt_sigprocmask"),
        (15, "__NR_rt_sigreturn"),
        (16, "__NR_ioctl"),
        (17, "__NR_pread64"),
        (18, "__NR_pwrite64"),
        (19, "__NR_readv"),
        (20, "__NR_writev"),
        (21, "__NR_access"),
        (22, "__NR_pipe"),
        (23, "__NR_select"),
        (24, "__NR_sched_yield"),
        (25, "__NR_mremap"),
        (26, "__NR_msync"),
        (27, "__NR_mincore"),
        (28, "__NR_madvise"),
        (29, "__NR_shmget"),
        (30, "__NR_shmat"),
        (31, "__NR_shmctl"),
        (32, "__NR_dup"),
        (33, "__NR_dup2"),
        (34, "__NR_pause"),
        (35, "__NR_nanosleep"),
        (36, "__NR_getitimer"),
        (37, "__NR_alarm"),
        (38, "__NR_setitimer"),
        (39, "__NR_getpid"),
        (40, "__NR_sendfile"),
        (41, "__NR_socket"),
        (42, "__NR_connect"),
        (43, "__NR_accept"),
        (44, "__NR_sendto"),
        (45, "__NR_recvfrom"),
        (46, "__NR_sendmsg"),
        (47, "__NR_recvmsg"),
        (48, "__NR_shutdown"),
        (49, "__NR_bind"),
        (50, "__NR_listen"),
        (51, "__NR_getsockname"),
        (52, "__NR_getpeername"),
        (53, "__NR_socketpair"),
        (54, "__NR_setsockopt"),
        (55, "__NR_getsockopt"),
        (56, "__NR_clone"),
        (57, "__NR_fork"),
        (58, "__NR_vfork"),
        (59, "__NR_execve"),
        (60, "__NR_exit"),
        (61, "__NR_wait4"),
        (62, "__NR_kill"),
        (63, "__NR_uname"),
        (64, "__NR_semget"),
        (65, "__NR_semop"),
        (66, "__NR_semctl"),
        (67, "__NR_shmdt"),
        (68, "__NR_msgget"),
        (69, "__NR_msgsnd"),
        (70, "__NR_msgrcv"),
        (71, "__NR_msgctl"),
        (72, "__NR_fcntl"),
        (73, "__NR_flock"),
        (74, "__NR_fsync"),
        (75, "__NR_fdatasync"),
        (76, "__NR_truncate"),
        (77, "__NR_ftruncate"),
        (78, "__NR_getdents"),
        (79, "__NR_getcwd"),
        (80, "__NR_chdir"),
        (81, "__NR_fchdir"),
        (82, "__NR_rename"),
        (83, "__NR_mkdir"),
        (84, "__NR_rmdir"),
        (85, "__NR_creat"),
        (86, "__NR_link"),
        (87, "__NR_unlink"),
        (88, "__NR_symlink"),
        (89, "__NR_readlink"),
        (90, "__NR_chmod"),
        (91, "__NR_fchmod"),
        (92, "__NR_chown"),
        (93, "__NR_fchown"),
        (94, "__NR_lchown"),
        (95, "__NR_umask"),
        (96, "__NR_gettimeofday"),
        (97, "__NR_getrlimit"),
        (98, "__NR_getrusage"),
        (99, "__NR_sysinfo"),
        (100, "__NR_times"),
        (101, "__NR_ptrace"),
        (102, "__NR_getuid"),
        (103, "__NR_syslog"),
        (104, "__NR_getgid"),
        (105, "__NR_setuid"),
        (106, "__NR_setgid"),
        (107, "__NR_geteuid"),
        (108, "__NR_getegid"),
        (109, "__NR_setpgid"),
        (110, "__NR_getppid"),
        (111, "__NR_getpgrp"),
        (112, "__NR_setsid"),
        (113, "__NR_setreuid"),
        (114, "__NR_setregid"),
        (115, "__NR_getgroups"),
        (116, "__NR_setgroups"),
        (117, "__NR_setresuid"),
        (118, "__NR_getresuid"),
        (119, "__NR_setresgid"),
        (120, "__NR_getresgid"),
        (121, "__NR_getpgid"),
        (122, "__NR_setfsuid"),
        (123, "__NR_setfsgid"),
        (124, "__NR_getsid"),
        (125, "__NR_capget"),
        (126, "__NR_capset"),
        (127, "__NR_rt_sigpending"),
        (128, "__NR_rt_sigtimedwait"),
        (129, "__NR_rt_sigqueueinfo"),
        (130, "__NR_rt_sigsuspend"),
        (131, "__NR_sigaltstack"),
        (132, "__NR_utime"),
        (133, "__NR_mknod"),
        (134, "__NR_uselib"),
        (135, "__NR_personality"),
        (136, "__NR_ustat"),
        (137, "__NR_statfs"),
        (138, "__NR_fstatfs"),
        (139, "__NR_sysfs"),
        (140, "__NR_getpriority"),
        (141, "__NR_setpriority"),
        (142, "__NR_sched_setparam"),
        (143, "__NR_sched_getparam"),
        (144, "__NR_sched_setscheduler"),
        (145, "__NR_sched_getscheduler"),
        (146, "__NR_sched_get_priority_max"),
        (147, "__NR_sched_get_priority_min"),
        (148, "__NR_sched_rr_get_interval"),
        (149, "__NR_mlock"),
        (150, "__NR_munlock"),
        (151, "__NR_mlockall"),
        (152, "__NR_munlockall"),
        (153, "__NR_vhangup"),
        (154, "__NR_modify_ldt"),
        (155, "__NR_pivot_root"),
        (156, "__NR__sysctl"),
        (157, "__NR_prctl"),
        (158, "__NR_arch_prctl"),
        (159, "__NR_adjtimex"),
        (160, "__NR_setrlimit"),
        (161, "__NR_chroot"),
        (162, "__NR_sync"),
        (163, "__NR_acct"),
        (164, "__NR_settimeofday"),
        (165, "__NR_mount"),
        (166, "__NR_umount2"),
        (167, "__NR_swapon"),
        (168, "__NR_swapoff"),
        (169, "__NR_reboot"),
        (170, "__NR_sethostname"),
        (171, "__NR_setdomainname"),
        (172, "__NR_iopl"),
        (173, "__NR_ioperm"),
        (174, "__NR_create_module"),
        (175, "__NR_init_module"),
        (176, "__NR_delete_module"),
        (177, "__NR_get_kernel_syms"),
        (178, "__NR_query_module"),
        (179, "__NR_quotactl"),
        (180, "__NR_nfsservctl"),
        (181, "__NR_getpmsg"),
        (182, "__NR_putpmsg"),
        (183, "__NR_afs_syscall"),
        (184, "__NR_tuxcall"),
        (185, "__NR_security"),
        (186, "__NR_gettid"),
        (187, "__NR_readahead"),
        (188, "__NR_setxattr"),
        (189, "__NR_lsetxattr"),
        (190, "__NR_fsetxattr"),
        (191, "__NR_getxattr"),
        (192, "__NR_lgetxattr"),
        (193, "__NR_fgetxattr"),
        (194, "__NR_listxattr"),
        (195, "__NR_llistxattr"),
        (196, "__NR_flistxattr"),
        (197, "__NR_removexattr"),
        (198, "__NR_lremovexattr"),
        (199, "__NR_fremovexattr"),
        (200, "__NR_tkill"),
        (201, "__NR_time"),
        (202, "__NR_futex"),
        (203, "__NR_sched_setaffinity"),
        (204, "__NR_sched_getaffinity"),
        (205, "__NR_set_thread_area"),
        (206, "__NR_io_setup"),
        (207, "__NR_io_destroy"),
        (208, "__NR_io_getevents"),
        (209, "__NR_io_submit"),
        (210, "__NR_io_cancel"),
        (211, "__NR_get_thread_area"),
        (212, "__NR_lookup_dcookie"),
        (213, "__NR_epoll_create"),
        (214, "__NR_epoll_ctl_old"),
        (215, "__NR_epoll_wait_old"),
        (216, "__NR_remap_file_pages"),
        (217, "__NR_getdents64"),
        (218, "__NR_set_tid_address"),
        (219, "__NR_restart_syscall"),
        (220, "__NR_semtimedop"),
        (221, "__NR_fadvise64"),
        (222, "__NR_timer_create"),
        (223, "__NR_timer_settime"),
        (224, "__NR_timer_gettime"),
        (225, "__NR_timer_getoverrun"),
        (226, "__NR_timer_delete"),
        (227, "__NR_clock_settime"),
        (228, "__NR_clock_gettime"),
        (229, "__NR_clock_getres"),
        (230, "__NR_clock_nanosleep"),
        (231, "__NR_exit_group"),
        (232, "__NR_epoll_wait"),
        (233, "__NR_epoll_ctl"),
        (234, "__NR_tgkill"),
        (235, "__NR_utimes"),
        (236, "__NR_vserver"),
        (237, "__NR_mbind"),
        (238, "__NR_set_mempolicy"),
        (239, "__NR_get_mempolicy"),
        (240, "__NR_mq_open"),
        (241, "__NR_mq_unlink"),
        (242, "__NR_mq_timedsend"),
        (243, "__NR_mq_timedreceive"),
        (244, "__NR_mq_notify"),
        (245, "__NR_mq_getsetattr"),
        (246, "__NR_kexec_load"),
        (247, "__NR_waitid"),
        (248, "__NR_add_key"),
        (249, "__NR_request_key"),
        (250, "__NR_keyctl"),
        (251, "__NR_ioprio_set"),
        (252, "__NR_ioprio_get"),
        (253, "__NR_inotify_init"),
        (254, "__NR_inotify_add_watch"),
        (255, "__NR_inotify_rm_watch"),
        (256, "__NR_migrate_pages"),
        (257, "__NR_openat"),
        (258, "__NR_mkdirat"),
        (259, "__NR_mknodat"),
        (260, "__NR_fchownat"),
        (261, "__NR_futimesat"),
        (262, "__NR_newfstatat"),
        (263, "__NR_unlinkat"),
        (264, "__NR_renameat"),
        (265, "__NR_linkat"),
        (266, "__NR_symlinkat"),
        (267, "__NR_readlinkat"),
        (268, "__NR_fchmodat"),
        (269, "__NR_faccessat"),
        (270, "__NR_pselect6"),
        (271, "__NR_ppoll"),
        (272, "__NR_unshare"),
        (273, "__NR_set_robust_list"),
        (274, "__NR_get_robust_list"),
        (275, "__NR_splice"),
        (276, "__NR_tee"),
        (277, "__NR_sync_file_range"),
        (278, "__NR_vmsplice"),
        (279, "__NR_move_pages"),
        (280, "__NR_utimensat"),
        (281, "__NR_epoll_pwait"),
        (282, "__NR_signalfd"),
        (283, "__NR_timerfd_create"),
        (284, "__NR_eventfd"),
        (285, "__NR_fallocate"),
        (286, "__NR_timerfd_settime"),
        (287, "__NR_timerfd_gettime"),
        (288, "__NR_accept4"),
        (289, "__NR_signalfd4"),
        (290, "__NR_eventfd2"),
        (291, "__NR_epoll_create1"),
        (292, "__NR_dup3"),
        (293, "__NR_pipe2"),
        (294, "__NR_inotify_init1"),
        (295, "__NR_preadv"),
        (296, "__NR_pwritev"),
        (297, "__NR_rt_tgsigqueueinfo"),
        (298, "__NR_perf_event_open"),
        (299, "__NR_recvmmsg"),
        (300, "__NR_fanotify_init"),
        (301, "__NR_fanotify_mark"),
        (302, "__NR_prlimit64"),
        (303, "__NR_name_to_handle_at"),
        (304, "__NR_open_by_handle_at"),
        (305, "__NR_clock_adjtime"),
        (306, "__NR_syncfs"),
        (307, "__NR_sendmmsg"),
        (308, "__NR_setns"),
        (309, "__NR_getcpu"),
        (310, "__NR_process_vm_readv"),
        (311, "__NR_process_vm_writev"),
        (312, "__NR_kcmp"),
        (313, "__NR_finit_module"),
        (314, "__NR_sched_setattr"),
        (315, "__NR_sched_getattr"),
        (316, "__NR_renameat2"),
        (317, "__NR_seccomp"),
        (318, "__NR_getrandom"),
        (319, "__NR_memfd_create"),
        (320, "__NR_kexec_file_load"),
        (321, "__NR_bpf"),
        (322, "__NR_execveat"),
        (323, "__NR_userfaultfd"),
        (324, "__NR_membarrier"),
        (325, "__NR_mlock2"),
        (326, "__NR_copy_file_range"),
        (327, "__NR_preadv2"),
        (328, "__NR_pwritev2"),
        (329, "__NR_pkey_mprotect"),
        (330, "__NR_pkey_alloc"),
        (331, "__NR_pkey_free"),
        (332, "__NR_statx"),
    ]
}
